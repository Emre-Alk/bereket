<!-- TODO: review the design maybe use a table element. see if can DRY with a partial withing a table (a pdf btn is needed)-->
<div class="mb-7">
  <% if current_user.donator? %>
    <%= link_to donator_root_path do %>
      <%= svg_tag('chevron-left', class:'size-6 stroke-2') %>
    <% end %>
  <% elsif current_user.asso? %>
    <%= link_to asso_root_path do %>
      <%= svg_tag('chevron-left', class:'size-6 stroke-2') %>
    <% end %>
  <% else %>
    <%= link_to root_path do %>
      <%= svg_tag('chevron-left', class:'size-6 stroke-2') %>
    <% end %>
  <% end %>

</div>

<div class="bg-white flex flex-col min-h-24 gap-2 divide-y divide-black/30 rounded-lg p-2 overflow-y-auto shadow-[0_0_12px_1px_rgba(0,0,0,0.1)] shadow-black/10">
  <% if @donations.empty? %>
    <p>Vous n'avez pas encore de dons.</p>
  <% end %>

  <% @donations.each do |don| %>
    <% if current_user.donator? %>

        <div class="bg-white flex flex-row px-2 pt-2 items-center gap-x-5">

          <%= link_to place_path(don.place), class:'flex flex-row items-center gap-4 w-3/4' do %>
            <div class="bg-white">
              <%= don.place.place_image.attached? ? cl_image_tag(don.place.place_image.key, class:'size-14 rounded-full') : image_tag("default_avatar.png", class:'size-14 rounded-full') %>
            </div>

            <div class="bg-white flex flex-col justify-evenly roboto-medium text-sm">
                <p><%= don.place.name %></p>
                <p><%= number_to_currency(don.amount.to_f / 100, locale: :fr, strip_insignificant_zeros: true) %></p>
                <p class="roboto-regular text-sm">Le <%= don.occured_on.strftime("%d/%m/%Y") %></p>
            </div>
          <% end %>

          <div data-controller="pdf-generate" data-pdf-generate-don-id-value="<%= don.id %>" data-pdf-generate-donator-id-value="<%= @donator.id %>" class="flex-none">

            <button data-action="click->pdf-generate#generate" data-pdf-generate-target="btn" class="bg-neutral-100 text-black text-center min-w-28 min-h-8 rounded-lg ">
              <p>Re√ßu Fiscal</p>
              <span class="hidden items-center justify-center min-w-28 min-h-8 rounded-lg bg-black spinner-<%= don.id %>">
                <%= icon("fa-solid", "circle-notch", class: "animate-spin", style:"color: white") %>
              </span>
            </button>

          </div>

        </div>

    <% else %>
      <div class="bg-white flex flex-row px-2 pt-2 items-center">

        <div class="flex flex-row items-center gap-4 w-full">
          <div class="bg-white">

            <% if don.donator.profile_image.attached? %>
              <%= cl_image_tag(don.donator.profile_image.key, class:"rounded-full size-14") %>
            <% else %>
              <div class="size-14 flex justify-center items-center bg-black rounded-full text-xl font-medium text-white">
                <%= don.donator.first_name[0].capitalize %><%= don.donator.last_name[0].capitalize %>
              </div>
            <% end %>

          </div>

          <div class="bg-white flex flex-col justify-evenly roboto-medium text-sm">
            <p><%= don.donator.first_name %> <%= don.donator.last_name %></p>
            <p><%= number_to_currency(don.amount_net.to_f / 100, locale: :fr, strip_insignificant_zeros: true) %></p>
            <p class="roboto-regular text-sm">Le <%= don.occured_on.strftime("%d/%m/%Y") %></p>
          </div>
        </div>

      </div>
    <% end %>


  <% end %>



</div>
