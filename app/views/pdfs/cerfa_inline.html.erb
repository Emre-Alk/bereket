<!--
<div class="h-dvh">
    <div class="sticky z-50 top-0 inset-x-0 bg-white flex justify-around items-center py-4">
      <button data-controller="pdf-download"
        data-action="click->pdf-download#download"
        data-pdf-download-url="<%= cerfa_donator_donation_path(@donator, @donation) %>"
        data-pdf-download-filename="cerfa.pdf">
        Download PDF
      </button>
    </div>

  <iframe src="<%= @pdf_inline %>" class="w-full h-4/5"></iframe>
</div>
-->

<!--
<div class="flex-grow" style="overflow: auto; -webkit-overflow-scrolling: touch;">
    <iframe
      src="<%= @pdf_url %>"
      style="overflow: auto; -webkit-overflow-scrolling: touch; border: none;"
      scrolling="yes"
      width="100%"
      height="100%">
    </iframe>
  </div>

-->

<div class="flex flex-col h-screen w-full overflow-hidden">
  <!-- Top Section: Buttons -->
  <div class="flex justify-between items-center w-full px-4 py-3 bg-white shadow-md">
    <button onclick="history.back()" class="bg-gray-200 text-gray-700 px-4 py-2 rounded-md text-sm">
      ‚¨Ö Retour
    </button>
    <div class="flex space-x-2">
      <a href="<%= @pdf_url %>" download class="bg-blue-500 text-white px-4 py-2 rounded-md text-sm">
        ‚¨á T√©l√©charger
      </a>
      <button onclick="sharePDF()" class="bg-green-500 text-white px-4 py-2 rounded-md text-sm">
        üì§ Partager
      </button>
    </div>
  </div>

  <!-- Scrollable PDF Viewer using <object> -->
  <div class="flex-grow overflow-auto">
    <object
      data="<%= @pdf_url %>#view=FitH"
      type="application/pdf"
      class="w-full h-full"
    >
      <!-- Fallback link for unsupported browsers -->
      <p class="text-center text-gray-700">Votre navigateur ne peut pas afficher ce PDF.
        <a href="<%= @pdf_url %>" class="text-blue-500 underline">Cliquez ici pour le t√©l√©charger</a>.
      </p>
    </object>
  </div>

  <!-- Bottom Section: Extra Margin to prevent iPhone navigation overlap -->
  <div class="h-6 bg-white"></div>
</div>

<script>
  // function sharePDF() {
  //   if (navigator.share) {
  //     navigator.share({ url: "<%= @pdf_url %>" })
  //       .catch((err) => console.error("Sharing failed", err));
  //   } else {
  //     alert("Le partage n'est pas pris en charge sur ce navigateur.");
  //   }
  // }

  // Prevent page scrolling, allow only PDF viewer to scroll
  document.body.style.overflow = 'hidden';
</script>
