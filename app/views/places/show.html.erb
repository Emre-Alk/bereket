<%# modal qr code %>
<div id="modal" data-controller="qrcode-modal" class="fixed z-50 bg-neutral-100 flex justify-center items-center inset-x-0 h-screen -bottom-full transition transform delay-0 duration-500 ease-in-out">
  <button class="absolute top-7 left-7" data-action="qrcode-modal#toggle">
    <%= svg_tag('cross_icon') %>
  </button>

  <div class="w-4/5 h-fit bg-neutral-100 flex flex-col items-center justify-center gap-y-3  ">
    <div class="flex flex-col items-center justify-center w-full gap-y-8 pb-8 pt-10 rounded-3xl bg-white">
      <%# qr code %>
      <%= qr_generate(@place.qr_code, class:'size-48') %>
      <%# place name upcase %>
      <h1 class="text-xl font-medium tracking-wide align-bottom"><%= @place.name.split(' ').map(&:upcase).join(' ') %></h1>
    </div>

    <div data-controller="share clipboard" class="w-full flex justify-between items-center gap-x-2">
      <%# share link  %>
      <button class="flex flex-col items-center justify-center w-1/2 rounded-lg py-2 bg-white"
              data-action="share#share"
              data-share-payload-param='{"url": "<%= @place.qr_code %>", "place":"<%= @place.name.split(' ').map(&:capitalize).join(' ') %>"}'>
        <%= svg_tag('share') %>
        <p class="text-sm tracking-wide">Partager</p>
      </button>

      <%# copy link  %>
      <button class="flex flex-col items-center justify-center w-1/2 rounded-lg py-2 bg-white"
              value="<%= @place.qr_code %>"
              data-action="clipboard#copy"
              data-clipboard-target="source">

        <%= svg_tag('link', class: "size-6", data: {clipboard_target:"defaultIcon"}) %>
        <%= svg_tag('check', class:'hidden size-6 stroke-2 stroke-black', data: {clipboard_target:"successIcon"}) %>
        <p class="text-sm tracking-wide">Copier le lien</p>
      </button>

    </div>

  </div>
</div>

<%# en tete %>
<div class="mb-5">
  <div class="relative flex justify-center items-center">
    <h1 class="text-lg font-medium tracking-wide"><%= @place.name.split(' ').map(&:capitalize).join(' ') %></h1>
    <span class="fa-stack fa-2xs scale-75" style="vertical-align: baseline;" >
      <%= icon('fa-solid', 'certificate', class:'fa-stack-2x', style:'color: #0471FF;') %>
      <%= icon('fa-solid', 'check', class:'fa-stack-1x', style:'color: white;') %>
    </span>

    <button class="absolute right-4" data-controller="qrcode-modal" data-action="qrcode-modal#toggle">
      <%= svg_tag('qr_code', class:'size-10 p-2 scale-75 text-white bg-black rounded-lg') %>
    </button>

  </div>
</div>

<%# banner of the place %>
<% if @place.place_image.attached? %>
  <div class="h-40">
      <img src="<%= @place.place_image %>" class="rounded-t-lg object-cover" alt="image of the place">
  </div>
<% else %>
  <div class="flex justify-center items-center h-40 w-full bg-gray-300">
    <%= svg_tag('image_empty', class:'size-20 bg-inherit text-gray-200') %>
  </div>
<% end %>


<div class="mb-4 mt-2 flex flex-row items-start justify-between mx-2">
  <%# ratings and score %>
  <div class="basis-1/4 flex-none flex justify-start items-center gap-x-1">
    <p class=" text-black"><%= @score%></p>
    <%= svg_tag('star', class:'size-4 scale-90 text-black') %>
    <p class=" font-light text-gray-600"><%= @reviews.length > 100 ? "(#{number_to_rounded(@reviews.length, local: :fr, precision: 0, round_mode: :down)}+)" : "(#{@reviews.length})" %></p>
  </div>

  <%# subscribe btn (feature for later so people can see posts from this place =/ than add to fav) %>

  <%# Donate btn %>
  <%= link_to "Faire un don", new_place_donation_path(@place), class:"flex justify-center py-2.5 px-5 bg-black text-white rounded-lg tracking-wide text-center"%>

  <%# ajouter en fav %>
  <div class="basis-1/4 flex-none flex justify-end">
    <% if @donator&.enrolled? %>
        <%= render partial:"favorites/favorite_icon", locals: { donator: @donator, place: @place, favorite: @favorite } %>
    <% end %>
  </div>
</div>

<%# info on place %>
<div class="flex flex-col border-y border-black/30 px-5 py-2">
  <%# address %>
  <div class="flex flex-row gap-4 justify-start items-center" data-controller="clipboard" >

    <%= icon("fa-solid", "location-dot") %>

    <button data-action="clipboard#copy" class="flex justify-start items-center gap-x-4">
      <span data-clipboard-target="source"><%= @place.street_no %> <%= @place.address %>, <%= @place.city %> <%= @place.zip_code %>, <%= @place.country %></span>
      <div>
        <span data-clipboard-target="defaultIcon"><%= svg_tag('clipboard', class:"size-3.5") %></span>
        <span data-clipboard-target="successIcon" class="hidden"><%= svg_tag('check', class:'size-4 stroke-2 stroke-black') %></span>
      </div>
    </button>

  </div>

  <%# Opening hours %>


</div>

<%# my wall %>
<div>
  <%# bio %>
  <div>
    <%# model bio to be created %>
  </div>

  <div>
    <%# links %>
  </div>

</div>

<%# share to the community %>
<div>
  <%# cagnotte for some project %>
</div>

<%# review card %>
<div class="px-5 py-5">
  <%# muezzin %>
  <%# imam %>
  <%# hutbe %>

  <%# propreté %>
  <%# qualité des activités/services %>
  <%# qualité des installations/equipements %>
  <%# emplacement %>
  <%= render partial:'reviews/index', locals: { reviews: @reviews } %>
</div>
